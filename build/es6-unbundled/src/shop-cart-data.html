<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/app-storage/app-localstorage/app-localstorage-document.html"></head><body><dom-module id="shop-cart-data"><template><app-localstorage-document key="shop-cart-data" data="{{cart}}"></app-localstorage-document></template><script>class ShopCartData extends Polymer.Element{static get is(){return"shop-cart-data"}static get properties(){return{cart:{type:Array,value:()=>[],notify:!0},numItems:{type:Number,computed:"_computeNumItems(cart.splices)",notify:!0},total:{type:Number,computed:"_computeTotal(cart.splices)",notify:!0}}}addItem(detail){let i=this._indexOfEntry(detail.item.name,detail.size);if(-1!==i){detail.quantity+=this.cart[i].quantity}this.setItem(detail)}setItem(detail){let i=this._indexOfEntry(detail.item.name,detail.size);if(0===detail.quantity){if(-1!==i){this.splice("cart",i,1)}}else{if(-1!==i){this.splice("cart",i,1,detail)}else{this.push("cart",detail)}}}clearCart(){this.cart=[]}_computeNumItems(){if(this.cart){return this.cart.reduce((total,entry)=>{return total+entry.quantity},0)}return 0}_computeTotal(){if(this.cart){return this.cart.reduce((total,entry)=>{return total+entry.quantity*entry.item.price},0)}return 0}_indexOfEntry(name,size){if(this.cart){for(let i=0,entry;i<this.cart.length;++i){entry=this.cart[i];if(entry.item.name===name&&entry.size===size){return i}}}return-1}}customElements.define(ShopCartData.is,ShopCartData);</script></dom-module></body></html>